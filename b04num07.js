// ----------------タッチイベントが利用可能かの判別-------------------------var supportTouch = 'ontouchend' in document;// イベント名var E_TOUCHSTART = supportTouch ? 'touchstart' : 'mousedown';var E_TOUCHMOVE = supportTouch ? 'touchmove' : 'mousemove';var E_TOUCHEND = supportTouch ? 'touchend' : 'mouseup';//=====================================================================//---　集めた数・10倍の数・1/10の数//=====================================================================function draw(id) {    var canvas = document.getElementById(id);    if (canvas == null)    	return false;		var context = canvas.getContext('2d');var mx;var my;var i;var j;var k;//---pketa(),wketa()内のカウント変数var p;//---乱数で作った問題5こ分のカウント用p=-1;var mhj;//---集めた数=0: 10倍の数=1: 1/10倍の=2;mhj=0;var c;c=0;var num;//ten_key入力の値var kkm;var mon;//入力された個数	mon=0;var pp=[];var ran=[];var kran=[];var kurai=[];var nkurai=[];var knum=[];var dm=[];var dmn=[];var hint=[];var mm=[];mm[0]="0";mm[1]="1";mm[2]="2";mm[3]="3";mm[4]="4";mm[5]="5";mm[6]="6";mm[7]="7";mm[8]="8";mm[9]="9";mm[16]="兆";mm[17]="億";mm[18]="万";var sss;var jjrnd;var dam;var no;//---乱数の配列var bnum;//---n桁の数字（問題）var kotae;	kotae=0;var kotae0;var bmoji;var monjj;monjj=0;var kosu=[];//---〜のいくつ分const pinp = new Audio('pinpon.mp3');const bu = new Audio("bubu.mp3");bgcolor();iniset();ten_key();//-----main()function main(){	bgcolor();	iniset();	ten_key();	ten_key_basyo();				kansj();			//kazu();			pketa();			dai();				nyuryoku();	select();	fig();}//------main()//=====number ↓function iniset(){//-----桁枠表示	context.strokeStyle = "blue";	for (i=0; i<16; i++){	if (i<12) {		context.strokeRect(40+27*i,10,27,75);//---54		if (i % 4 == 0) {			context.moveTo(40+27*i, 10);			context.lineTo(40+27*i, 110);			context.stroke();			}		} else {		context.strokeRect(40+27*i,10,27,100);		}	}		context.moveTo(40,60);		context.lineTo(472,60);		context.stroke();for(i=0; i<4; i++){context.fillStyle = 'rgba(255, 255, 255, 0.3)'context.fillRect(40+i*108,60,27,50/2);if (i==3){context.fillRect(40+i*108,60,27,50);}context.fillStyle = 'rgba(0, 0, 255, 0.3)'context.fillRect(67+i*108,60,27,50/2);if(i==3){context.fillRect(67+i*108,60,27,50);}context.fillStyle = 'rgba(255, 255, 0, 0.3)'context.fillRect(94+i*108,60,27,50/2);if(i==3){context.fillRect(94+i*108,60,27,50);}context.fillStyle = 'rgba(255, 0, 0, 0.3)'context.fillRect(121+i*108,60,27,50/2);if(i==3){context.fillRect(121+i*108,60,27,50);}}		context.fillStyle = 'blue';		context.font = "20px Arial";		for (i=0; i<4; i++){		context.fillText("千",45+i*108,80);		context.fillText("百",72+i*108,80);		context.fillText("十",99+i*108,80);		context.fillText("一",126+i*108,80);		}		context.fillText("兆",114,105);		context.fillText("億",222,105);		context.fillText("万",320,105);context.fillStyle = 'rgba(0, 255, 0, 0.1)'context.fillRect(40,85,108,25)context.fillStyle = 'rgba(0, 255, 0, 0.2)'context.fillRect(40+4*27,85,108,25)context.fillStyle = 'rgba(0, 255, 0, 0.3)'context.fillRect(40+8*27,85,108,25)context.strokeStyle = "blue";context.strokeRect(40, 85, 324,25);//216}function kansj(){		dm[0]="１兆";dmn[0]=1;hint[0]=100000000;		dm[1]="１０００億";dmn[1]=1000;hint[1]=10000000;		dm[2]="１００億";dmn[2]=100;hint[2]=1000000;		dm[3]="１０億";dmn[3]=10;hint[3]=100000;		dm[4]="１億";dmn[4]=1;hint[4]=10000;		dm[5]="１０００万";dmn[5]=1000;hint[5]=1000;		dm[6]="１００万";dmn[6]=100;hint[6]=100;			j=0;	for (i=0; i<=12; i++){		if (dm[i]!=""){kurai[j]=dm[i]; nkurai[j]=dmn[i];j=j+1}else{}	}}function kan_su(n){//-----<数>を<単位つき数>に変換		var syo0=n;		var syo1=syo0-n%10000;		var tann1, tann2;		if ( knum[i] == 0) {tann2="兆";}		if ( knum[i] < 5 && knum[i] >0 ){tann1="兆";tann2="億";}		if ( knum[i] >4 ){tann1="億";tann2="万";}		if(syo1==0){				kotae0=syo0+tann2;				}else{			if(syo0-syo1 == 0){				kotae0=syo1/10000+tann1;				}else{				kotae0=syo1/10000+tann1+(syo0-syo1)+tann2;			}		}}//----function kan_su()function pketa(){//------数字を位の配列に入れる		for (k=0; k<12; k++){kran[k]="";}//-----		bmoji=String(bnum);		var cc=12;		for (k=bmoji.length; k>=0; k--){			kran[cc] = bmoji.substr( k, 1 );			cc=cc-1;		}}function wketa(){//-----位の枠の中に表示する		context.fillStyle = 'red';		context.font = "30px Arial";		for (k=0; k<12; k++){context.fillText(kran[k],45+27*k,50);}//-----		for (k=12; k<16; k++){context.fillText("0",45+27*k,50);}}function dai(){		context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText("（"+c+"）",5, 146);	//for (i=0; i<5; i++) {			i=p;					if (mhj==1) {kan_su(kosu[i]*dmn[knum[i]]);}//---問題表示用		if (mhj==2) {kan_su(kosu[i]*dmn[knum[i]]*10);}//---問題表示用			if (mhj==0) {bnum=hint[knum[i]];}//else{bnum=kosu[i]*hint[knum[i]]*10}			if (mhj==1) {bnum=kosu[i]*hint[knum[i]]}			if (mhj==2) {bnum=kosu[i]*hint[knum[i]]*10}						pketa();			wketa();			context.fillStyle = 'blue';			context.font = "24px Arial";						if (mhj==0){				context.fillText(dm[knum[i]],80, 146);//+i*20);				context.fillText("　　　を　"+kosu[i]+" こ集めた数は,　",140, 146);//+i*20);				}else{				if (mhj==1){context.fillText(kotae0+"　の"+"１０倍の数は,",140, 146);}//+i*20);				if (mhj==2){context.fillText(kotae0+"　の"+"１／１０の数は,",140, 146);}//+i*20);			}		context.fillText("です。",376, 140+4*26+6);		context.strokeRect(40,223,326,32);				if (mhj==0) {kan_su(kosu[i]*dmn[knum[i]]);}		if (mhj==1) {kan_su(kosu[i]*dmn[knum[i]]*10);}//---問題の答え		if (mhj==2) {kan_su(kosu[i]*dmn[knum[i]]);}}//=====numberfunction random(){ran[0]=Math.floor(Math.random() * 9) + 1 ;k=1;while(k<=5){	jjrnd=0;	dam=Math.floor(Math.random() * 9) + 1 ;	for (i=0; i<k; i++){if (ran[i]==dam){jjrnd=1;}}	if (jjrnd==1) { } else {ran[i]=dam; k++;}	}//------	knum[0]=Math.floor(Math.random() * 7) //+ 1 ;k=1;while(k<=5){	jjrnd=0;	dam=Math.floor(Math.random() * 7) //;+ 1 ;	for (i=0; i<k; i++){if (knum[i]==dam){jjrnd=1;}}	if (jjrnd==1) { } else {knum[i]=dam; k++;}	}//}kosu2 = Math.floor(Math.random() * 3) +1kosu[0]=Math.floor(Math.random() * Math.pow(9,kosu2)) +9k=1;while(k<=5){	jjrnd=0;	dam = Math.floor(Math.random() * 3) +1	dam=Math.floor(Math.random() * Math.pow(7,dam)) +2	for (i=0; i<k; i++){if (kosu[i]==dam){jjrnd=1;}}	if (jjrnd==1) { } else {kosu[i]=dam; k++;}	}}function pinbu (a,b){	var a;	var b;	if (a==0) {		pinp.volume = b;		pinp.play();		} else {		bu.volume = b;		bu.play();		}}//-----数値入力function nyuryoku(){		//var h;var t; var o;		if((mx>49 && mx<410) && (my>260 && my<320)){			pp[mon]=mm[num];			//if (mon<3){mon++;}//---3桁まで入力			if (mon<bmoji.length + 4){mon++;}//---文字数分まで入力		}		//context.fillText(num,54+s1*20,250);}//-----数値入力表示function fig(){		var s1;		context.fillStyle = 'red';		context.font = "28px Arial";		for (s1=0; s1<mon; s1++){		context.fillText(pp[s1],54+s1*30,250);//175-----ansx+s1*13,ansy);//---13は字間		}}//-----　← M A N 押下時の処理function select(){//mx184	if((mx>49 && mx<500) && (my>260 && my<320)){		if(num==12){				    if(p>4){p=0;}else{p++;}						//mhj = Math.floor(Math.random() * 3);			mhj = p%3;			console.log(p);			kotae=0;			mon=0;			c=c+1;			bgcolor();			iniset();			ten_key();			if (p==0){random();}			kansj();						console.log(mhj);			dai();					}				if(num==11){if(mon>0){mon=mon-1;}}		if(num==13){			//rline();			mon=mon-1;			kotae="";				for (i=0; i<mon+1; i++){				kotae=kotae+pp[i];				}						if(kotae0 ==kotae){				pinbu(0,0.5);				mon=mon+1;				context.fillStyle = 'red';				context.font = "96px Arial";				context.fillText("◯", 360,210);				wketa();			}else{mon=0;pinbu(1,0.5);}						iniset();			ten_key();			dai();			rline();		}		if(num==14){//-----次の問題			bgcolor();			iniset();			ten_key();			c=0;			mon=0;		}	}}//-----テンキー表示function ten_key(){		//bgcolor_btm();		context.fillStyle='#afeeee';		for(i=0; i<7; i++){			for(j=0; j<2; j++){				context.fillStyle='#afeeee'				fillRoundRect(context,　184+i*45,260+j*30, 43, 28, 5);				if (i<5){					context.fillStyle = 'blue';					context.font = "24px Arial";					if(j==0){context.fillText(i+1,194+4+i*45,24+260+j*28);}						else{if(i==4){context.fillText(i-4,194+4+i*45,24+260+j*28);}						else{context.fillText(i+6,194+4+i*45,24+260+j*28);}}					} else {}			}		}				context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText("←",194+5*45,24+260);		context.fillText("問",194+6*45,24+260);		context.fillText("答",194+5*45,24+260+28);		context.font = "14px Arial";		context.fillText("（1）",185+6*45,24+260+28);				//---位表示		for(i=1; i<4; i++){		j=1;		context.fillStyle= 'rgba(0, 255, 0, 0.3)'//'#afeeee'		fillRoundRect(context,　4+i*45,260+j*30, 43, 28, 5);		context.fillStyle = 'blue';		context.font = "18px Arial";		context.fillText(mm[i+15],8+8+i*45,24+260+j*28);		}}//-----テンキー押下時の値取得function ten_key_basyo(){	rline();//点線丸囲いが描かれてしまうので入れておく		if((mx>184 && mx<229) && (my>260 && my<290)){num=1;}	if((mx>229 && mx<274) && (my>260 && my<290)){num=2;}	if((mx>274 && mx<319) && (my>260 && my<290)){num=3;}	if((mx>319 && mx<360) && (my>260 && my<290)){num=4;}	if((mx>360 && mx<405) && (my>260 && my<290)){num=5;}		if((mx>405 && mx<450) && (my>260 && my<290)){num=11;}	if((mx>450 && mx<495) && (my>260 && my<290)){num=12;}		if((mx>184 && mx<229) && (my>290 && my<320)){num=6;}	if((mx>229 && mx<274) && (my>290 && my<320)){num=7;}	if((mx>274 && mx<319) && (my>290 && my<320)){num=8;}	if((mx>319 && mx<360) && (my>290 && my<320)){num=9;}	if((mx>360 && mx<405) && (my>290 && my<320)){num=0;}		if((mx>405 && mx<450) && (my>290 && my<320)){num=13;}	if((mx>450 && mx<495) && (my>290 && my<320)){num=14;}	//if((mx>49 && mx<94) && (my>290 && my<320)){kkm=1;}	//if((mx>94 && mx<138) && (my>290 && my<320)){kkm=2;}	//if((mx>138 && mx<183) && (my>290 && my<320)){kkm=3;}	if((mx>49 && mx<94) && (my>290 && my<320)){num=16;}//"兆";}	if((mx>94 && mx<138) && (my>290 && my<320)){num=17;}//"億";}	if((mx>138 && mx<183) && (my>290 && my<320)){num=18;}//"万";}	}//-----実線にもどすfunction rline(){		context.beginPath();		context.setLineDash([]);		context.closePath();}function bgcolor(){	context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'	context.fillRect(0,0,500,320);}function bgcolor_bm(){	context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'	context.fillRect(290,40,230,180);}//------マル四角を描画するfunction-----//------https://qiita.com/PG0721/items/6fb9e9c02675be832402---よりfunction fillRoundRect(context, x, y, w, h, r) {    createRoundRectPath(context, x, y, w, h, r);    context.fill();}function createRoundRectPath(context, x, y, w, h, r) {    context.beginPath();    context.moveTo(x + r, y);    context.lineTo(x + w - r, y);    context.arc(x + w - r, y + r, r, Math.PI * (3/2), 0, false);    context.lineTo(x + w, y + h - r);    context.arc(x + w - r, y + h - r, r, 0, Math.PI * (1/2), false);    context.lineTo(x + r, y + h);           context.arc(x + r, y + h - r, r, Math.PI * (1/2), Math.PI, false);    context.lineTo(x, y + r);    context.arc(x + r, y + r, r, Math.PI, Math.PI * (3/2), false);    context.closePath();}//------マル四角を描画するfunctionここまで-----//----Canvas全体をクリアするfunctionfunction cls(){	context.clearRect(0,0,canvas.width,canvas.height);}//-----ここからマウスの位置を取得するcanvas.addEventListener(E_TOUCHSTART, onTouchStart);	function onTouchStart(e) {	canvas.addEventListener(E_TOUCHMOVE, onTouchMove);	canvas.addEventListener(E_TOUCHEND, onTouchEnd);}function onTouchMove(e) {	//cls();}function onTouchEnd(e) {	canvas.removeEventListener(E_TOUCHMOVE, onTouchMove);	canvas.removeEventListener(E_TOUCHEND, onTouchEnd);	mx=e.pageX;	my=e.pageY;		main();	console.log("x= "+mx+" : y= "+my)//------コンソールに座標を表示console.log(kotae);}// デフォルトのイベントを禁止	document.ontouchmove = function(evt){	evt.preventDefault();	}}//-------最終かっこ>>>function draw(id) { 