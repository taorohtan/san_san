// ----------------タッチイベントが利用可能かの判別-------------------------var supportTouch = 'ontouchend' in document;// イベント名var E_TOUCHSTART = supportTouch ? 'touchstart' : 'mousedown';var E_TOUCHMOVE = supportTouch ? 'touchmove' : 'mousemove';var E_TOUCHEND = supportTouch ? 'touchend' : 'mouseup';//=====================================================================//---　数直線 --- メモリの高さに合わせて指示位置を表示//               数値の間も乱数で指定//=====================================================================function draw(id) {    var canvas = document.getElementById(id);    if (canvas == null)    	return false;		var context = canvas.getContext('2d');var mx;var my;var c;var p=0;var m=0;//-----正答数var num;//ten_key入力の値var bx;//-----ten_key押下時着色用座標var by;var mm=[];mm[0]="0";mm[1]="1";mm[2]="2";mm[3]="3";mm[4]="4";mm[5]="5";mm[6]="6";mm[7]="7";mm[8]="8";mm[9]="9";mm[16]="1000";mm[17]="100";mm[18]="10";//--------------------------var bty=[];var dx=[];var bty2=[];var bty3=[];//---10;100;1000;0.1;0.01;0.001var bj;var bbj;var bnum=[];var boxj=1;var kai0=[];var kai1=[];var stp;//---開始時刻と現在時刻との差var ms00;//---開始時刻var swch;//---- =0 --> スタート： =1 --> ストップvar notm=0;//----- =0 --> 計時する : =1 --> 計時しない（function Tm() 内で条件指定）var swj=0;//----- 現在時刻をスタート0とするvar ttm=0;//---合計時間var wt=300;//-----ten_color 待ち時間（0.3秒）const pinp = new Audio('pinpon.mp3');const bu = new Audio("bubu.mp3");//-----startbgcolor();ten_key();opn();ntm();//var j;//var i=0//bai_y=10;//-----0.01の十分の一描画	var sm=0.5;	context.fillStyle = '#ffffe0'	context.fillRect(413,192,116*sm,116*sm);	context.fillStyle = 'blue'	context.lineWidth = 1;	context.strokeRect(413,192,116*sm,116*sm);	context.fillStyle = 'rgba(0, 255, 0, 0.5)';context.fillRect(413,192,10*sm,116*sm);	for (j=1; j<10; j++){			context.beginPath();			context.lineWidth = 0.5;//-----線の太さ			context.strokeStyle='rgba(0, 0, 255, 0.5)'			context.moveTo(413+(j*116/10)*sm, 192);			context.lineTo(413+(j*116/10)*sm, 192+116*sm);			context.closePath();			context.stroke();						context.beginPath();			context.lineWidth = 0.5;//-----線の太さ			context.strokeStyle='rgba(255, 0, 0, 0.5)'			context.moveTo(379,215);			context.lineTo(413,192);			context.moveTo(379,227);			context.lineTo(413,192+116*sm);						context.closePath();			context.stroke();	}//-----0.01の十分の一描画ここまでms00 = Date.now();swj=1;//-----main()function main(){	bgcolor();	//ntm();	ten_key();	ten_key_basyo();	select();			if (swch==0 && swj==0){ms00 = Date.now();swj=1;}		if (swch==0 && notm==0){Tm();}			if(boxj==1){bai_box(110)}	if(c>=11 && c<=20){bgcolor();ten_key();}	if(num==14 || num==13){}else{mondai();}	ten_color();//-----必要	ntm();}//------main()//----------function bai_sen(j,dx){//-----倍矢印表示	var j; var x; var dx; var dy;//-----x=140 or x=140*2	x=140*dx;	dy=10;				context.lineWidth = 1				context.strokeStyle = 'rgba(0, 0, 255, 1)';	if(j==0){		context.beginPath();		context.arc(120+x, 100-dy, 160, Math.PI * 69 / 180, Math.PI*111/180, false);		context.lineTo(80+x,250-dy)		context.lineTo(76+x,253-dy)		context.stroke();	}					if(j==1){			if(dx==2){dx=1;x=140}			context.beginPath();			context.arc(120+65+x, -84-dy, 360, Math.PI * 69 / 180, Math.PI*111/180, false);			context.lineTo(72+x,252-dy)			context.lineTo(68+x,256-dy)			context.stroke();	}	if(j==2){			context.beginPath();			context.arc(120+138, -292-dy, 580, Math.PI * 69 / 180, Math.PI*111/180, false);			context.lineTo(66,250-dy)			context.lineTo(62,254-dy)			context.stroke();	}//-----	if(j==3){			context.beginPath();			context.lineTo(166+x,66+dy)			context.lineTo(166+x,60+dy)			context.arc(120+x, 220+dy, 160, -Math.PI * 69 / 180, -Math.PI*111/180, true);			context.stroke();	}	if(j==4){			if(dx==2){dx=1;x=140}			context.beginPath();			context.lineTo(310+x,67+dy)			context.lineTo(310+x,61+dy)			context.arc(120+65+x, 426+dy, 380, -Math.PI * 69 / 180, -Math.PI*111/180, true);			context.stroke();	}	if(j==5){			context.beginPath();			context.lineTo(446,66+dy)			context.lineTo(446,60+dy)			context.arc(120+128, 612+dy, 580, -Math.PI * 69 / 180, -Math.PI*111/180, true);			context.stroke();	}}				function bai_box(bai_y){//-----倍BOX表示	var i; var j; var bai_y;	for (i=0; i<4; i++){		context.fillStyle = 'blue';context.font = "20px Arial";		context.fillText(1/10**i,40+i*124,bai_y-10);		context.fillStyle = 'rgba(255, 0, 0, 0.5)';context.font = "40px Arial";		context.fillText(1/10**i,40+i*115,bai_y-10+80);					context.lineWidth = 1		context.strokeStyle = 'blue';context.strokeRect(6+i*124,bai_y,116,116);	}	i=0;	context.fillStyle = 'rgba(0, 255, 0, 0.5)';context.fillRect(6+i*124,bai_y,116,116);	for(i=1; i<4; i++){		for (j=1; j<10; j++){			context.beginPath();			context.lineWidth = 0.3;//-----線の太さ			context.strokeStyle='blue'			context.moveTo(6+i*124+j*116/10, bai_y);//190);			context.lineTo(6+i*124+j*116/10, bai_y+116);//190);			if(i>1){				context.moveTo(6+i*124, bai_y+j*116/10);//190);				context.lineTo(6+i*124+116, bai_y+j*116/10);//190);				}		context.closePath();		context.stroke();		}	}	i=1;j=0;	context.fillStyle = 'rgba(0, 255, 0, 0.5)';context.fillRect(6+i*124+j*116/10, bai_y,116/10,116);	i=2;j=9;	context.fillStyle = 'rgba(0, 255, 0, 0.5)';context.fillRect(6+i*124, bai_y+j*116/10,116/10,116/10);	i=3;j=9;	context.fillStyle = 'rgba(0, 255, 0, 1)';context.fillRect(6+i*124, bai_y+j*116/10,4,116/10);		//-----0.01の十分の一描画	var sm=0.5;	context.fillStyle = '#ffffe0'	context.fillRect(413,192,116*sm,116*sm);	context.fillStyle = 'blue'	context.lineWidth = 1;	context.strokeRect(413,192,116*sm,116*sm);	context.fillStyle = 'rgba(0, 255, 0, 0.5)';context.fillRect(413,192,10*sm,116*sm);	for (j=1; j<10; j++){			context.beginPath();			context.lineWidth = 0.5;//-----線の太さ			context.strokeStyle='rgba(0, 0, 255, 0.5)'			context.moveTo(413+(j*116/10)*sm, 192);			context.lineTo(413+(j*116/10)*sm, 192+116*sm);			context.closePath();			context.stroke();						context.beginPath();			context.lineWidth = 0.5;//-----線の太さ			context.strokeStyle='rgba(255, 0, 0, 0.5)'			context.moveTo(379,215);			context.lineTo(413,192);			context.moveTo(379,227);			context.lineTo(413,192+116*sm);						context.closePath();			context.stroke();	}//-----0.01の十分の一描画ここまで}//----------function opn(){	bgcolor();	if(boxj==1){bai_box(110)}	ten_key();}function rnd(){	var i; var k; var jjrnd; var dam;if(c<11){	bty[0]=Math.floor(Math.random() * 6);	k=1;	while(k<6){		jjrnd=0;		dam=Math.floor(Math.random() * 6) ;			for (i=0; i<k; i++){if (bty[i]==dam){jjrnd=1;}}		if (jjrnd==1) { } else {bty[i]=dam; k++;}	}	for(i=0; i<6; i++){	dx[i]=Math.floor(Math.random() * 3);}	}else{	//if(c>10){	bty2[0]=Math.floor(Math.random() * 6);	k=1;	while(k<6){		jjrnd=0;		dam=Math.floor(Math.random() * 6) ;			for (i=0; i<k; i++){if (bty2[i]==dam){jjrnd=1;}}		if (jjrnd==1) { } else {bty2[i]=dam; k++;}	}	for(i=0; i<6; i++){if(bty2[i]<3){bty3[i]=10**(bty2[i]+1)}else{bty3[i]=1/10**(bty2[i]-2)}}	bnum[0]=Math.floor(Math.random() * 99) + 1;	k=1;	while(k<6){		jjrnd=0;		dam=Math.floor(Math.random() * 99) + 1 ;			for (i=0; i<k; i++){if (bnum[i]==dam){jjrnd=1;}}		if (jjrnd==1) { } else {bnum[i]=dam; k++;}	}}}function mondai(){var i;var k;if(c>20){//c=1;p=0;m=0;			swch=1;bgcolor();ten_key();			}else{	if(c<11){		opn()				if(c>10){			swch=1;			context.fillStyle = 'red';context.font = "20px Arial";			w_time(stp,350, 20, 0);			}else{if(boxj==1)bai_sen(bty[p],dx[p])}		if(p<5){}else{rnd();p=0}			}else{			var ss;				if(c<21){			k=1;			while(k<100){//-----小数点数値以下に000...が表示されないようにする処理（kのカウントはしていない）				bnum[p]=bnum[p]/10**Math.floor(Math.random() * 2)				if(String(bnum[p]).length>10 || String(bnum[p]*bty3[p]).length>10){if(p>5){rnd()};p++;}else{k=101}			}			if(typeof bnum[p]=="undefined" || isNaN(bnum[p])==true){if(p>5){rnd()};p++;}			context.fillStyle = 'blue';context.font = "48px Arial";			context.fillText(bnum[p],100,105);			context.fillStyle = 'red';context.font = "48px Arial";			context.fillText(bnum[p]*bty3[p],300,105);		}				if(p<5){}else{rnd();p=0}		yaji_R()	}			context.fillStyle = 'blue';		context.font = "22px Arial";		context.fillText("("+c+")",20,30);				for(i=0; i<m; i++){				context.fillStyle='red';context.font = "14px Arial";context.fillText("◯", 60+i*15,34);		}}//-----if(c>20)}function pinbu (a,b){	var a;	var b;	if (a==0) {		pinp.volume = b;		pinp.play();		} else {		bu.volume = b;		bu.play();		}}//-----　← M A N 押下時の処理function select(){		if(num==13){			if(notm==0){				notm=1				}else{				notm=0				}		}			if((mx>453 && mx<500) && (my>260 && my<320)){			bgcolor();ten_key()			if(num==12){							c=1;				p=0;				m=0;//-----正答数				st=0;swch=0;swj=0;boxj=1;				rnd();				mondai()							}							if(num==14){//-----(1)			swch=1;			boxj=1;			c=1;p=0;m=0;					}}	if((mx>48 && mx<316) && (my>290 && my<320) && c<21){		if(num==11){		}		if(bty2[p]==0){bj=0;bbj="10 倍"}		if(bty2[p]==1){bj=1;bbj="100 倍"}		if(bty2[p]==2){bj=2;bbj="1000 倍"}		if(bty2[p]==3){bj=3;bbj="10"}		if(bty2[p]==4){bj=4;bbj="100"}		if(bty2[p]==5){bj=5;bbj="1000"}				wt=300;		if(num==0){			if(bty[p]==0 && c<11){m++;pinbu(0,0.5);}			if(bty2[p]==0 && c>10){m++;pinbu(0,0.5);}else{wt=600}		}		if(num==1){			if(bty[p]==1 && c<11){m++;pinbu(0,0.5);}			if(bty2[p]==1 && c>10){m++;pinbu(0,0.5);}else{wt=600}		}		if(num==2){			if(bty[p]==2 && c<11){m++;pinbu(0,0.5);}			if(bty2[p]==2 && c>10){m++;pinbu(0,0.5);}else{wt=600}		}		if(num==3){			if(bty[p]==3 && c<11){m++;pinbu(0,0.5);}			if(bty2[p]==3 && c>10){m++;pinbu(0,0.5);}else{wt=600}		}		if(num==4){			if(bty[p]==4 && c<11){m++;pinbu(0,0.5);}			if(bty2[p]==4 && c>10){m++;pinbu(0,0.5);}else{wt=600}		}		if(num==5){			if(bty[p]==5 && c<11){m++;pinbu(0,0.5);}			if(bty2[p]==5 && c>10){m++;pinbu(0,0.5);}else{wt=600}		}				p++;c++;		mondai()	}}//-----テンキー表示function ten_key(){		context.fillStyle='#afeeee';		for(i=6; i<7; i++){			for(j=0; j<2; j++){				context.fillStyle='#afeeee'				fillRoundRect(context,　184+i*45,260+j*30, 43, 28, 5);			}		}		for(i=0; i<3; i++){				j=1;				context.fillStyle='#afeeee';				fillRoundRect(context,　184+i*45,260+j*30, 43, 28, 5);					context.fillStyle = 'blue';					context.font = "12px Arial";					context.fillText(10*10**i,4+194+i*42,24+260+j*28);		}				context.fillStyle = 'blue';		context.font = "20px Arial";		//context.fillText("←",194+5*45,24+260);		context.fillText("問",194+6*45,24+260);		//context.fillText("答え",194+5*45,24+260+28);		//context.font = "12px Arial";		//context.fillText("（1）",185+6*45,24+260+28);		//---位表示		for(i=1; i<4; i++){		j=1;				context.fillStyle= 'rgba(0, 255, 0, 0.3)'//'#afeeee'		fillRoundRect(context,　4+i*45,260+j*30, 43, 28, 5);		context.fillStyle = 'blue';		context.font = "13px Arial";		context.fillText(mm[i+15],3+8+i*46,24+260+j*28);		context.fillText(1,8+8+i*46,270+j*28);		//}		context.beginPath();		context.lineWidth = 0.3;//-----線の太さ		context.strokeStyle='blue'		context.moveTo(56+(i-1)*44, 300);//190);		context.lineTo(86+(i-1)*44, 300);//190);		context.closePath();		context.stroke();				}}//-----テンキー押下時の値取得function ten_key_basyo(){	rline();//点線丸囲いが描かれてしまうので入れておく		if((mx>405 && mx<450) && (my>260 && my<290)){num=11;bx=409;by=260;}	if((mx>450 && mx<495) && (my>260 && my<290)){num=12;bx=454;by=260;}		if((mx>184 && mx<229) && (my>290 && my<320)){num=0;bx=184;by=290;}	if((mx>229 && mx<274) && (my>290 && my<320)){num=1;bx=229;by=290;}	if((mx>274 && mx<319) && (my>290 && my<320)){num=2;bx=274;by=290;}	if((mx>405 && mx<450) && (my>290 && my<320)){num=13;bx=405;by=290;}		if((mx>450 && mx<495) && (my>290 && my<320)){num=14;bx=454;by=290;}	if((mx>49 && mx<94) && (my>290 && my<320)){num=5;bx=49;by=290;}//"兆";}	if((mx>94 && mx<138) && (my>290 && my<320)){num=4;bx=94;by=290;}//"億";}	if((mx>138 && mx<183) && (my>290 && my<320)){num=3;bx=138;by=290;}//"万";}}function ten_color(){if((mx>48 && mx<316) && (my>290 && my<320) || (mx>450 && mx<495) && (my>260 && my<320)){		context.fillStyle='rgba(0, 255, 0, 0.5)';		fillRoundRect(context, bx, by, 43, 28, 5);				context.fillStyle='red'//'rgba(0, 255, 0, 0.5)';		context.font = "40px Arial";				if(c>11 && wt==600){			context.fillStyle='red'//'rgba(0, 255, 0, 0.5)';			context.font = "40px Arial";			if(bj<3){context.fillText(bbj,200,170);}else{							var dx=-10				context.fillText(1,dx+240+(5-bj)*3,170);				context.fillText(bbj,dx+208+(5-bj)*14,210);								context.beginPath();				context.lineWidth = 1;//-----線の太さ				context.strokeStyle='red'				context.moveTo(dx+215, 175);//190);				context.lineTo(dx+295, 175);//190);				context.closePath();				context.stroke();			}		}		//---以下で0.3秒( 300 )まち色づけをなくす（もとの色で再描画 0〜9 ）				setTimeout(function(){				context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'		if(c>10){context.fillRect(190,120,200,100);}		context.fillRect(48,290,270,30);//-----テンキー部分				if(c>20){			context.fillStyle = 'red';context.font = "48px Arial";			if(notm==0){w_time(stp,120, 100, 1);}else{}			context.fillText(m+" 問正解！!",120,150)		}		ten_key()		},wt);	}}//-----矢印function yaji_R(){	context.beginPath();	context.moveTo(270,90);	context.lineTo(250,110);	context.lineTo(250,100);	context.lineTo(230,100);	context.lineTo(230,80);	context.lineTo(250,80);	context.lineTo(250,70);	context.closePath();	context.fillStyle='rgba(0, 0, 255, 0.3)';	context.fill();}function yaji_L(){	context.beginPath();	context.moveTo(230,90);	context.lineTo(250,110);	context.lineTo(250,100);	context.lineTo(270,100);	context.lineTo(270,80);	context.lineTo(250,80);	context.lineTo(250,70);	context.closePath();	context.fillStyle='rgba(0, 0, 255, 0.3)';	context.fill();}//====================================================function Tm(){//-----単純なストップウォッチ　ここから	//ms00 = Date.now();//Date.now()は現在時刻をミリ秒で示す//-----現在時刻取得と時計描画を、10ミリ秒ごとに実行する	setInterval(() => {		stp = Date.now() - ms00;//スタート時と現在の時間差		if(swch==0 && notm==0){		time_color();//---時間表示のためのマスク		context.fillStyle = 'red';		context.font = "20px Arial";		w_time(stp,350, 20, 0);//---経過時間表示	}	}, 10);//-----単純なストップウォッチ　ここまで:以下のfunction w_time()も必要}//---function Tm()function w_time(tt,x,y,fg){		var tt;x;y;fg;		var m = Math.floor(tt / 60000);		var s = Math.floor(tt % 60000 / 1000);		var ms = tt % 1000;			m = ('0' + m).slice(-2); 		s = ('0' + s).slice(-2);		ms = ('0' + ms).slice(-2);		if(fg==0){context.fillText(m+"\'"+ s + "\""+ms, x, y);}		if(fg==1){context.fillText(m+"分"+ s + "秒", x, y);}}function time_color(){	context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'	context.fillRect(350,0,200,28);}function ntm(){		context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText("T",194+5*45,24+260+28);		context.font = "12px Arial";		if(notm==0){context.fillText("G O",189+5*45,24+260+27);}}//====================================================//-----実線にもどすfunction rline(){		context.beginPath();		context.setLineDash([]);		context.closePath();}function bgcolor(){	context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'	context.fillRect(0,0,500,320);}function bgcolor_bm(){	context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'	context.fillRect(290,40,230,180);}//------マル四角を描画するfunction-----//------https://qiita.com/PG0721/items/6fb9e9c02675be832402---よりfunction fillRoundRect(context, x, y, w, h, r) {    createRoundRectPath(context, x, y, w, h, r);    context.fill();}function createRoundRectPath(context, x, y, w, h, r) {    context.beginPath();    context.moveTo(x + r, y);    context.lineTo(x + w - r, y);    context.arc(x + w - r, y + r, r, Math.PI * (3/2), 0, false);    context.lineTo(x + w, y + h - r);    context.arc(x + w - r, y + h - r, r, 0, Math.PI * (1/2), false);    context.lineTo(x + r, y + h);           context.arc(x + r, y + h - r, r, Math.PI * (1/2), Math.PI, false);    context.lineTo(x, y + r);    context.arc(x + r, y + r, r, Math.PI, Math.PI * (3/2), false);    context.closePath();}//------マル四角を描画するfunctionここまで-----//----Canvas全体をクリアするfunctionfunction cls(){	context.clearRect(0,0,canvas.width,canvas.height);}//-----ここからマウスの位置を取得するcanvas.addEventListener(E_TOUCHSTART, onTouchStart);	function onTouchStart(e) {	canvas.addEventListener(E_TOUCHMOVE, onTouchMove);	canvas.addEventListener(E_TOUCHEND, onTouchEnd);}function onTouchMove(e) {	//cls();}function onTouchEnd(e) {	canvas.removeEventListener(E_TOUCHMOVE, onTouchMove);	canvas.removeEventListener(E_TOUCHEND, onTouchEnd);	mx=e.pageX;	my=e.pageY;	if((mx>48 && mx<316) && (my>290 && my<320) || (mx>450 && mx<495) && (my>260 && my<320) || (mx>405 && mx<450) && (my>290 && my<320)){	main();}console.log("x= "+mx+" : y= "+my)//------コンソールに座標を表示console.log("bx= "+bx+" : by= "+by)//console.log("num= "+num+" : swch= "+swch)//console.log("stnr="+stnr+" : edn="+edn)//console.log("bmoji[0]= "+bmoji[0]+" : bmoji[1]= "+bmoji[1]+" : bmoji[2]= "+bmoji[2])//console.log("c= "+c+" : p= "+p+" : bnum[p]= "+bnum[p])}// デフォルトのイベントを禁止	document.ontouchmove = function(evt){	evt.preventDefault();	}}//-------最終かっこ>>>function draw(id) { 