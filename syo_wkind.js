// ----------------タッチイベントが利用可能かの判別-------------------------var supportTouch = 'ontouchend' in document;// イベント名var E_TOUCHSTART = supportTouch ? 'touchstart' : 'mousedown';var E_TOUCHMOVE = supportTouch ? 'touchmove' : 'mousemove';var E_TOUCHEND = supportTouch ? 'touchend' : 'mouseup';//=====================================================================function draw(id) {    var canvas = document.getElementById(id);    if (canvas == null)    	return false;		var context = canvas.getContext('2d');var mx;var my;var i;var ie;var ss="";var s1;var s2;ran=[];var dy=-30;var pp;var c=0;var num;//ten_key入力の値var mon;//入力された個数	mon=0;var bx;//-----ten_key押下時着色用座標var by;var mm=[];mm[0]="0";mm[1]="1";mm[2]="2";mm[3]="3";mm[4]="4";mm[5]="5";mm[6]="6";mm[7]="7";mm[8]="8";mm[9]="9";mm[16]="";mm[17]="";mm[18]=".";var bmoji=[];var pp0=[]; var pp1=[]; var pp2=[]; var pp3=[]; var pp4=[];var kotae;var bmoji=[];//--------------------------//var ch0=0; var ch1=0; var ch2=0;var chc0=0; var chc1=0; var chc2=0; var chc3=0; var chc4=0;//----入力場所var chk0=0; var chk1=0; var chk2=0; var chk3=0; var chk4=0;//----入力表示var chcj;//-----chc No.var fgj=1;const pinp = new Audio('pinpon.mp3');const bu = new Audio("bubu.mp3");bgcolor();ten_key();function main(){bgcolor();mondai();ten_key();ten_key_basyo();select();nyuryoku()fig();var i;//---◯表示	context.fillStyle = 'red';	context.font = "36px Arial";	if(chk0==1){for(i=0;i<chcj;i++){context.fillText("◯", 450,90+i*36);}}}function mondai(){ss="";s1="";s2="";		context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText("（"+c+"）",0, 48);	context.fillStyle = 'blue';	context.font = "32px Arial";	for(i=1;i<3;i++){ss=ss+String(ran[i])}	context.fillText(ran[0]+"."+ss,70,50);	if(ran[1]==4){s2=10-ran[2];s2="0.0"+String(s2);}else{}	if(ran[1]==5){s2="0.0"+String(ran[2])}else{}	if(ran[1]==9){s2=10-ran[2];s2="0.0"+String(s2)}else{}	if(ran[1]<4){s2="0.0"+String(ran[2]);}else{}	if(ran[1]>5&&ran[1]<9){s2=10-ran[2];s2="0.0"+String(s2);}else{}	bmoji[0]="0."+String(ss);	bmoji[1]=String(ran[0])+String(ss);	bmoji[2]=String(ran[1]);bmoji[3]=String(ran[2]);	bmoji[4]=s2;			context.strokeStyle = 'rgba(255, 0, 0, 1)'		context.strokeRect(60,20,380,34)		context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText("は，どんな数といえますか。",160,48)		context.fillText("をあわせた数です。",160,dy+50+2*36)		context.fillText("集めた数です。",220,dy+50+3*36)		context.fillText("あわせた数です。",240,dy+45+5*36)			context.font = "28px Arial";	context.fillText(ran[0]+" と ",30,dy+50+2*36)	context.fillText("0.01"+" を        こ",30,dy+50+3*36)	context.fillText("1"+" を "+ran[0]+" こ, "+"0.1"+" を    こ, "+"0.01"+" を    こ ",30,dy+50+4*36)	if(ran[1]==4){s1=5;s2=10-ran[2];	context.fillText(ran[0]+"."+ss+" は "+ran[0]+"."+s1+" より",30,dy+50+6*36)}else{}	if(ran[1]==5){s1=ran[0]+"."+ran[1];	context.fillText(ran[0]+"."+ss+" は "+s1+" より",30,dy+50+6*36)}else{}	if(ran[1]==9){s1=ran[0]+1;s2=10-ran[2];	context.fillText(ran[0]+"."+ss+" は "+s1+" より",30,dy+50+6*36)}else{}	if(ran[1]<4){if(ran[1]==0){s1=ran[0]}else{s1=ran[0]+"."+ran[1];}	context.fillText(ran[0]+"."+ss+" は "+s1+" より",30,dy+50+6*36)}else{}	if(ran[1]>5&&ran[1]<9){s1=ran[1]+1;s1=ran[0]+"."+s1;s2=10-ran[2];	context.fillText(ran[0]+"."+ss+" は "+s1+" より",30,dy+50+6*36)}else{}}function pinbu (a,b){	var a;	var b;	if (a==0) {		pinp.volume = b;		pinp.play();		} else {		bu.volume = b;		bu.play();		}}//-----function random(){var i; var k; var jjrnd;ran[0]=Math.floor(Math.random() * 9) + 1 ;k=1;while(k<3){	jjrnd=0;	if(k==1){dam=Math.floor(Math.random() * 10) ;}else{		dam=Math.floor(Math.random() * 9) +1;}	for (i=1; i<k; i++){if (ran[i]==dam){jjrnd=1;}}	if (jjrnd==1) { } else {ran[i]=dam; k++;}	}	}//-----数値入力function nyuryoku(){		if((mx>49 && mx<410) && (my>260 && my<320)){			if(chc0==1){pp0[mon]=mm[num];}			if(chc1==1){pp1[mon]=mm[num];}			if(chc2==1){pp2[mon]=mm[num];}			if(chc3==1){pp3[mon]=mm[num];}			if(chc4==1){pp4[mon]=mm[num];}			if (mon<10){mon++;}//---10文字まで入力			//if (mon<bmoji.length + 4){mon++;}//---文字数分まで入力		}}//-----数値入力表示function fig(){		var s1; var by;		context.fillStyle = 'red';		context.font = "28px Arial";		for (s1=0; s1<mon; s1++){			if(chc0==1){context.fillText(pp0[s1],85+s1*16,dy+50+2*36);}			if(chc1==1){context.fillText(pp1[s1],85+42+s1*16,dy+50+3*36);}			if(chc2==1){context.fillText(pp2[s1],240+s1*16,dy+50+4*36);}			if(chc3==1){context.fillText(pp3[s1],406+s1*16,dy+50+4*36);}			if(chc4==1){context.fillText(pp4[s1],240+s1*16-pp,dy+50+6*36);}		}		if(fgj==0){}else{		context.strokeStyle = 'rgba(0, 0, 255, 0.5)'		if(chc0==1){context.strokeStyle = "red";}else{context.strokeStyle = 'rgba(0, 0, 255, 0.8)'}			context.strokeRect(82,dy+96,70,32)		if(chc1==1){context.strokeStyle = "red";}else{context.strokeStyle = 'rgba(0, 0, 255, 0.8)'}			context.strokeRect(85+1*36,dy+96+1*36,62,32)		if(chc2==1){context.strokeStyle = "red";}else{context.strokeStyle = 'rgba(0, 0, 255, 0.8)'}			context.strokeRect(85+4*37,dy+96+2*36,30,32)		if(chc3==1){context.strokeStyle = "red";}else{context.strokeStyle = 'rgba(0, 0, 255, 0.8)'}			context.strokeRect(85+8*39,dy+96+2*36,30,32)		if(chc4==1){context.strokeStyle = "red";}else{context.strokeStyle = 'rgba(0, 0, 255, 0.8)'}		if(ran[1]==9||ran[1]==0||(ran[0]==9&&ran[1]==9)){if(ran[0]==9&&ran[1]==9){pp=6;}else{pp=22}			context.strokeRect(85+4*37-pp,dy+96+4*36,76,32)}			else{pp=0;context.strokeRect(85+4*37,dy+96+4*36,76,32)}		if((ran[1]>5 && ran[1]<10)||ran[1]==4){var bs="小さい"}else{var bs="大きい"}		context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText(bs+"数です。",320-pp,dy+48+6*36)}		context.fillStyle = 'red';		context.font = "28px Arial";		if(chk0==1){context.fillText(bmoji[0],85,dy+50+2*36);}		if(chk1==1){context.fillText(bmoji[1],85+42,dy+50+3*36);}		if(chk2==1){context.fillText(bmoji[2],240,dy+50+4*36);}		if(chk3==1){context.fillText(bmoji[3],406,dy+50+4*36);}		if(chk4==1){context.fillText(bmoji[4],240-pp,dy+50+6*36);}}function chch(a){var a;		chc0=0;chc1=0;chc2=0;chc3=0;chc4=0;				if(a==0){chc0=1;}		if(a==1){chc1=1;}		if(a==2){chc2=1;}		if(a==3){chc3=1;}		if(a==4){chc4=1;}}//-----　← M A N 押下時の処理function select(){var i;	if((mx>184 && mx<500) && (my>260 && my<320)){			if(num==12){			//kotae=0;			bgcolor();			mon=0;			fgj=0;			chk0=0; chk1=0; chk2=0; chk3=0; chk4=0;//----入力表示			c=c+1;						fgj=1;			//bgcolor();						random();			mondai();			chcj=0;			chch(chcj)						ten_key();					}				if(num==11){if(mon>0){mon=mon-1;}}		if(num==13){						mon=mon-1;						kotae="";			for (i=0; i<mon+1; i++){				if(chc0==1){kotae=kotae+pp0[i];}				if(chc1==1){kotae=kotae+pp1[i];}				if(chc2==1){kotae=kotae+pp2[i];}				if(chc3==1){kotae=kotae+pp3[i];}				if(chc4==1){kotae=kotae+pp4[i];}			}							if(chc0==1){kotae0=bmoji[0];}				if(chc1==1){kotae0=bmoji[1];}				if(chc2==1){kotae0=bmoji[2];}				if(chc3==1){kotae0=bmoji[3];}				if(chc4==1){kotae0=bmoji[4];}									if(kotae0 == kotae){				pinbu(0,0.5);				mon=mon+1;				//context.fillStyle = 'red';				//context.font = "96px Arial";				//context.font = "36px Arial";				//context.fillText("◯", 360,205);				//for(i=0;i<chcj+1;i++){context.fillText("◯", 450,90+i*36);}				if(chc0==1){chk0=1;mon=0;}				if(chc1==1){chk1=1;mon=0;}				if(chc2==1){chk2=1;mon=0;}				if(chc3==1){chk3=1;mon=0;}				if(chc4==1){chk4=1;mon=0;}				chcj=chcj+1;				chch(chcj);							}else{mon=0;pinbu(1,0.5);}					}		if(num==14){//-----(1)			fgj=0;			chk0=0; chk1=0; chk2=0; chk3=0; chk4=0;//----入力表示			bgcolor();			ten_key();			c=0;			mon=0;					}	}}//-----テンキー表示function ten_key(){var i; var j;		context.fillStyle='#afeeee';		for(i=0; i<8; i++){			for(j=0; j<2; j++){				context.fillStyle='#afeeee'				//----- 184 --> 138				if(i==5){}else{fillRoundRect(context,　138+i*45,260+j*30, 43, 28, 5);}				if (i<5){					context.fillStyle = 'blue';					context.font = "24px Arial";					//----- 194+4 --> 149+5					if(j==0){context.fillText(i+1,149+5+i*45,24+260+j*28);}						else{if(i==4){context.fillText(i-4,149+5+i*45,24+260+j*28);}						else{context.fillText(i+6,149+5+i*45,24+260+j*28);}}					} else {}			}		}				context.fillStyle = 'blue';		context.font = "20px Arial";		context.fillText("←",194+5*45,24+260);		context.fillText("問",194+6*45,24+260);		context.fillText("答",194+5*45,24+260+28);		context.fillText(".",194+4*45,24+260+28);		context.font = "14px Arial";		context.fillText("（1）",185+6*45,24+260+28);				//---位表示		//for(i=1; i<4; i++){		i=8;		j=1;				context.fillStyle= 'rgba(0, 255, 0, 0.3)'//'#afeeee'		fillRoundRect(context,　3+i*45,260+j*30, 43, 28, 5);		context.fillStyle = 'blue';		context.font = "18px Arial";		context.fillText(mm[(i-5)+15],8+8+i*45,24+260+j*28);		//}}//-----テンキー押下時の値取得function ten_key_basyo(){	//rline();//点線丸囲いが描かれてしまうので入れておく		if((mx>139 && mx<184) && (my>260 && my<290)){num=1;}	if((mx>184 && mx<229) && (my>260 && my<290)){num=2;}	if((mx>229 && mx<274) && (my>260 && my<290)){num=3;}	if((mx>274 && mx<319) && (my>260 && my<290)){num=4;}	if((mx>319 && mx<360) && (my>260 && my<290)){num=5;}	//if((mx>360 && mx<405) && (my>260 && my<290)){num=5;}			if((mx>405 && mx<450) && (my>260 && my<290)){num=11;bx=409;by=260;ten_color()}	if((mx>450 && mx<495) && (my>260 && my<290)){num=12;bx=454;by=260;ten_color()}		if((mx>139 && mx<184) && (my>290 && my<320)){num=6;}	if((mx>184 && mx<229) && (my>290 && my<320)){num=7;}	if((mx>229 && mx<274) && (my>290 && my<320)){num=8;}	if((mx>274 && mx<319) && (my>290 && my<320)){num=9;}	if((mx>319 && mx<360) && (my>290 && my<320)){num=0;}	if((mx>360 && mx<405) && (my>290 && my<320)){num=18;}		if((mx>405 && mx<450) && (my>290 && my<320)){num=13;bx=409;by=289;ten_color()}	if((mx>450 && mx<495) && (my>290 && my<320)){num=14;bx=454;by=289;ten_color()}		//----- 184 --> 139	if(num>0 && num<6){bx=139+45*(num-1);by=260;ten_color()}	if(num>5 && num<10){bx=139+45*(num-6);by=289;ten_color()}	if(num==0){bx=319;by=289;ten_color()}	//if(num>15 && num<19){bx=4+45*(num-10);by=290;ten_color()}	if(num>15 && num<19){bx=364;by=289;ten_color()}}function ten_color(){var i; var j;	//if((mx>139 && mx<495) && (my>262 && my<320)||(mx>49 && mx<184) && (my>289 && my<320)) {	if((mx>139 && mx<495) && (my>262 && my<320)) {		context.fillStyle='rgba(0, 255, 0, 0.5)';		fillRoundRect(context, bx, by, 43, 28, 5);		//---以下で0.3秒( 300 )まち色づけをなくす（もとの色で再描画 0〜9 ）		setTimeout(function(){				if((mx>139 && mx<495) && (my>262 && my<320)) {			context.fillStyle='#afeeee'			fillRoundRect(context, bx, by, 43, 28, 5);						context.fillStyle = 'blue';			context.font = "24px Arial";			context.fillText("0",112,488);			for(i=0; i<5; i++){				for(j=0; j<3; j++){					//----- 194+4 --> 149+5					if(j==0){context.fillText(i+1,149+5+i*45,24+260+j*28);}						else{if(i==4){context.fillText(i-4,149+5+i*45,24+260+j*28);}						else{context.fillText(i+6,149+5+i*45,24+260+j*28);}}				}			}			context.fillStyle = 'blue';			context.font = "20px Arial";			context.fillText("←",194+5*45,24+260);			context.fillText("問",194+6*45,24+260);			context.fillText("答",194+5*45,24+260+28);			context.fillText(".",194+4*45,24+260+28);			context.font = "14px Arial";			context.fillText("（1）",185+6*45,24+260+28);			}					if((mx>360 && mx<405) && (my>290 && my<320)){			context.fillStyle='#ffffe0'//-----地の色で描画しておかないとなぜか色が重なってしまう			fillRoundRect(context, bx, by, 43, 28, 5);			context.fillStyle = 'rgba(0, 255, 0, 0.3)';			//fillRoundRect(context, bx, by, 43, 28, 5);						i=8;j=1;			fillRoundRect(context,3+i*45,260+j*30, 43, 28, 5)			context.fillStyle = 'blue';			context.font = "18px Arial";			context.fillText(mm[(i-5)+15],8+8+i*45,24+260+j*28);			}		},300);	}}//----------------	function bgcolor(){		context.fillStyle='#ffffe0'//'rgba(0, 255, 0, 0.5)'		context.fillRect(0,0,500,320);	}	//------マル四角を描画するfunction-----//------https://qiita.com/PG0721/items/6fb9e9c02675be832402---よりfunction fillRoundRect(context, x, y, w, h, r) {    createRoundRectPath(context, x, y, w, h, r);    context.fill();}function createRoundRectPath(context, x, y, w, h, r) {    context.beginPath();    context.moveTo(x + r, y);    context.lineTo(x + w - r, y);    context.arc(x + w - r, y + r, r, Math.PI * (3/2), 0, false);    context.lineTo(x + w, y + h - r);    context.arc(x + w - r, y + h - r, r, 0, Math.PI * (1/2), false);    context.lineTo(x + r, y + h);           context.arc(x + r, y + h - r, r, Math.PI * (1/2), Math.PI, false);    context.lineTo(x, y + r);    context.arc(x + r, y + r, r, Math.PI, Math.PI * (3/2), false);    context.closePath();}//------マル四角を描画するfunctionここまで-----//----Canvas全体をクリアするfunctionfunction cls(){	context.clearRect(0,0,canvas.width,canvas.height);}//-----ここからマウスの位置を取得するcanvas.addEventListener(E_TOUCHSTART, onTouchStart);	function onTouchStart(e) {	canvas.addEventListener(E_TOUCHMOVE, onTouchMove);	canvas.addEventListener(E_TOUCHEND, onTouchEnd);}function onTouchMove(e) {	//cls();}function onTouchEnd(e) {	canvas.removeEventListener(E_TOUCHMOVE, onTouchMove);	canvas.removeEventListener(E_TOUCHEND, onTouchEnd);	mx=e.pageX;	my=e.pageY;		main();		console.log("x= "+mx+" : y= "+my)//------コンソールに座標を表示}// デフォルトのイベントを禁止	document.ontouchmove = function(evt){	evt.preventDefault();	}}//-------最終かっこ>>>function draw(id) { 